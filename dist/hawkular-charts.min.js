angular.module("hawkular.charts",[]);var Charts;!function(t){"use strict";function e(t,e,a){var n=d3.svg.line().interpolate("monotone").x(function(e){return t(e.timestamp)}).y(function(t){return e(a)});return n}function a(t,a,n){var r=t.svg.selectAll("path.alertLine").data([t.chartData]);r.attr("class",n).attr("d",e(t.timeScale,t.yScale,a)),r.enter().append("path").attr("class",n).attr("d",e(t.timeScale,t.yScale,a)),r.exit().remove()}function n(t,e){function a(t,e){var a,n=[];return t.forEach(function(r,i){0===i&&r.avg>e?n.push(i):(a=t[i-1],r.avg>e&&a&&(!a.avg||a.avg<=e)&&n.push(a.avg?i-1:i))}),n}function n(e,a){var n,r,o,s=[];return e.forEach(function(e){o=t[e];for(var c=e;c<t.length-1;c++)if(n=t[c],r=t[c+1],n.avg>a&&r.avg<=a||n.avg>a&&!r.avg){s.push(new i(o.timestamp,r.avg?r.timestamp:n.timestamp,a));break}}),s.length===e.length-1&&s.push(new i(t[e[e.length-1]].timestamp,t[t.length-1].timestamp,a)),s}var r,o;return o=a(t,e),r=n(o,e)}function r(t,e,a){function r(e){e.attr("class","alertBounds").attr("x",function(e){return t.timeScale(e.startTimestamp)}).attr("y",function(){return t.yScale(a)}).attr("height",function(e){return t.height-40}).attr("width",function(e){return t.timeScale(e.endTimestamp)-t.timeScale(e.startTimestamp)})}var i=n(t.chartData,e),o=t.svg.select("g.alertHolder").selectAll("rect.alertBounds").data(i);o.call(r),o.enter().append("rect").call(r),o.exit().remove()}var i=function(){function t(t,e,a){this.startTimestamp=t,this.endTimestamp=e,this.alertValue=a,this.startDate=new Date(t),this.endDate=new Date(e)}return t}();t.AlertBound=i,t.createAlertLine=a,t.createAlertBoundsArea=r}(Charts||(Charts={}));var Charts;!function(t){"use strict";var e=angular.module("hawkular.charts"),a=function(){function t(t){this.value=t}return t.prototype.toString=function(){return this.value},t.UP="up",t.DOWN="down",t.UNKNOWN="unknown",t}();t.AvailStatus=a;var n=function(){function t(t,e,a,n,r,i,o){this.start=t,this.end=e,this.value=a,this.startDate=n,this.endDate=r,this.duration=i,this.message=o,this.duration=moment(e).from(moment(t),!0),this.startDate=new Date(t),this.endDate=new Date(e)}return t}();t.TransformedAvailDataPoint=n;var r=function(){function e(r){var i=this;this.restrict="E",this.replace=!0,this.scope={data:"=",startTimestamp:"@",endTimestamp:"@",timeLabel:"@",dateLabel:"@",chartTitle:"@"},this.link=function(o,s,c){function l(t){return"<div class='chartHover'>\n            <div class='info-item'>\n              <span class='chartHoverLabel'>Status:</span>\n              <span class='chartHoverValue'>"+t.value.toUpperCase()+"</span>\n            </div>\n            <div class='info-item before-separator'>\n              <span class='chartHoverLabel'>Duration:</span>\n              <span class='chartHoverValue'>"+t.duration+"</span>\n            </div>\n          </div>"}function u(){H&&P.selectAll("*").remove(),P=d3.select(s[0]),H=P.append("svg").attr("viewBox","0 0 760 150").attr("preserveAspectRatio","xMinYMin meet"),T=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(t){return l(t)}),M=H.append("g").attr("width",k+R.left+R.right).attr("height",V).attr("transform","translate("+R.left+","+G+")"),M.append("defs").append("pattern").attr("id","diagonal-stripes").attr("patternUnits","userSpaceOnUse").attr("patternTransform","scale(0.7)").attr("width",4).attr("height",4).append("path").attr("d","M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2").attr("stroke","#B6B6B6").attr("stroke-width",1.2),M.call(T)}function m(e){var a=[];_=+c.startTimestamp||d3.min(e,function(t){return t.start})||+moment().subtract(1,"hour"),e&&e.length>0&&(a[0]=_,a[1]=b||+moment(),x=d3.scale.linear().clamp(!0).rangeRound([70,0]).domain([0,175]),A=d3.svg.axis().scale(x).ticks(0).tickSize(0,0).orient("left"),S=d3.time.scale().range([0,k]).domain(a),w=d3.svg.axis().scale(S).tickSize(-70,0).orient("top").tickFormat(t.xAxisTimeFormats()))}function d(t){return t.value===a.UP.toString()}function f(t){return t.value===a.UNKNOWN.toString()}function h(t){function e(t,e){return t.timestamp<e.timestamp?-1:t.timestamp>e.timestamp?1:0}var r=[],i=t.length;if(t.sort(e),t&&i>0&&t[0].timestamp){var o=(new Date).getTime();if(1===i){var s=t[0];r.push(new n(o-36e5,s.timestamp,a.UNKNOWN.toString())),r.push(new n(s.timestamp,o,s.value))}else for(var c=o,l=t.length;l>0;l--){if(_>=t[l-1].timestamp){r.push(new n(_,c,t[l-1].value));break}r.push(new n(t[l-1].timestamp,c,t[l-1].value)),c=t[l-1].timestamp}}return r}function p(){M.append("text").attr("class","availUpLabel").attr("x",-10).attr("y",25).style("font-family","Arial, Verdana, sans-serif;").style("font-size","12px").attr("fill","#999").style("text-anchor","end").text("Up"),M.append("text").attr("class","availDownLabel").attr("x",-10).attr("y",55).style("font-family","Arial, Verdana, sans-serif;").style("font-size","12px").attr("fill","#999").style("text-anchor","end").text("Down")}function v(t){function e(t){return I-o(0)+(d(t)||f(t)?0:35)}function a(t){return o(0)-(f(t)?15:50)}function n(t){return d(t)?"#54A24E":f(t)?"url(#diagonal-stripes)":"#D85054"}var r=d3.max(t,function(t){return+t.end}),i=d3.time.scale().range([0,k]).domain([_,b||r]),o=d3.scale.linear().clamp(!0).range([I,0]).domain([0,4]);M.selectAll("rect.availBars").data(t).enter().append("rect").attr("class","availBars").attr("x",function(t){return i(+t.start)}).attr("y",function(t){return e(t)}).attr("height",function(t){return a(t)}).attr("width",function(t){var e=b?Math.min(+t.end,b):+t.end;return i(e)-i(+t.start)}).attr("fill",function(t){return n(t)}).attr("opacity",function(){return.85}).on("mouseover",function(t,e){T.show(t,e)}).on("mouseout",function(){T.hide()}).on("mousedown",function(){var t=M.select(".brush").node(),e=new Event("mousedown");e.pageX=d3.event.pageX,e.clientX=d3.event.clientX,e.pageY=d3.event.pageY,e.clientY=d3.event.clientY,t.dispatchEvent(e)}).on("mouseup",function(){var t=M.select(".brush").node(),e=new Event("mouseup");e.pageX=d3.event.pageX,e.clientX=d3.event.clientX,e.pageY=d3.event.pageY,e.clientY=d3.event.clientY,t.dispatchEvent(e)}),M.append("line").attr("x1",0).attr("y1",70).attr("x2",655).attr("y2",70).attr("stroke-width",.5).attr("stroke","#D0D0D0"),p()}function g(){M.selectAll("g.axis").remove(),C=M.append("g").attr("class","x axis").call(w),M.append("g").attr("class","y axis").call(A)}function y(){function e(){M.classed("selecting",!0)}function a(){var e=D.extent(),a=Math.round(e[0].getTime()),n=Math.round(e[1].getTime()),i=n-a;i>=6e4&&r.$broadcast(t.EventNames.AVAIL_CHART_TIMERANGE_CHANGED.toString(),e),E.call(D.clear())}D=d3.svg.brush().x(S).on("brushstart",e).on("brushend",a),E=M.append("g").attr("class","brush").call(D),E.selectAll(".resize").append("path"),E.selectAll("rect").attr("height",70)}var x,S,A,w,C,D,E,T,H,P,M,_=+c.startTimestamp,b=+c.endTimestamp,L=e._CHART_HEIGHT,R={top:10,right:5,bottom:5,left:90},k=e._CHART_WIDTH-R.left-R.right,N=L-50,I=N-R.top-R.bottom,F=30,B=10,V=I+R.top-F-B,G=+F+B+R.top;o.$watchCollection("data",function(t){t&&(i.transformedDataPoints=h(angular.fromJson(t)),o.render(i.transformedDataPoints))}),o.$watchGroup(["startTimestamp","endTimestamp"],function(t){_=+t[0]||_,b=+t[1]||b,o.render(i.transformedDataPoints)}),o.render=function(t){t&&t.length>0&&(u(),m(t),g(),y(),v(t))}}}return e.Factory=function(){var t=function(t){return new e(t)};return t.$inject=["$rootScope"],t},e._CHART_HEIGHT=150,e._CHART_WIDTH=750,e}();t.AvailabilityChartDirective=r,e.directive("hkAvailabilityChart",r.Factory())}(Charts||(Charts={}));var Charts;!function(t){"use strict";var e=angular.module("hawkular.charts"),a=function(){function e(a){var n=this;this.restrict="E",this.replace=!0,this.scope={data:"=",showYAxisValues:"="},this.link=function(r,i,o){function s(){S&&A.selectAll("*").remove(),A=d3.select(i[0]);var t=i[0].parentNode;E=t.clientWidth,T=t.clientHeight,H=T-C.top-C.bottom-e._XAXIS_HEIGHT,P=T+C.top,S=A.append("svg").attr("width",E-C.left-C.right).attr("height",P),w=S.append("g").attr("transform","translate("+C.left+", 0)").attr("class","contextChart")}function c(e){p=d3.time.scale().range([0,E-10]).nice().domain([e[0].timestamp,e[e.length-1].timestamp]),v=d3.svg.axis().scale(p).tickSize(4,0).tickFormat(t.xAxisTimeFormats()).orient("bottom"),w.selectAll("g.axis").remove(),g=w.append("g").attr("class","x axis").attr("transform","translate(0,"+H+")").call(v);var a=d3.min(e,function(t){return t.avg}),n=d3.max(e,function(t){return t.avg});n+=.03*n,a-=.05*a,d=d3.scale.linear().rangeRound([H,0]).nice().domain([a,n]);var r=m?2:0;f=d3.svg.axis().scale(d).ticks(r).tickSize(4,0).orient("left"),h=w.append("g").attr("class","y axis").call(f);var i=d3.svg.area().interpolate("cardinal").defined(function(t){return!t.empty}).x(function(t){return p(t.timestamp)}).y0(function(t){return H}).y1(function(t){return d(t.avg)}),o=d3.svg.line().interpolate("cardinal").defined(function(t){return!t.empty}).x(function(t){return p(t.timestamp)}).y(function(t){return d(t.avg)}),s=w.selectAll("path.contextLine").data([e]);s.attr("class","contextLine").transition().attr("d",o),s.enter().append("path").attr("class","contextLine").transition().attr("d",o),s.exit().remove();var c=w.append("g").attr("class","context");c.append("path").datum(e).transition().duration(500).attr("class","contextArea").attr("d",i)}function l(){function e(){w.classed("selecting",!0)}function n(){var e=y.extent(),n=Math.round(e[0].getTime()),r=Math.round(e[1].getTime()),i=r-n;i>=6e4&&a.$broadcast(t.EventNames.CONTEXT_CHART_TIMERANGE_CHANGED.toString(),e)}y=d3.svg.brush().x(p).on("brushstart",e).on("brushend",n),g.append("g").selectAll("rect").attr("y",0).attr("height",T-10),x=w.append("g").attr("class","brush").call(y),x.selectAll(".resize").append("path"),x.selectAll("rect").attr("height",T+17)}function u(t){return t?t.map(function(t){var e=t.timestamp||t.start+(t.end-t.start)/2;return{timestamp:e,value:angular.isNumber(t.value)?t.value:void 0,avg:t.empty?void 0:t.avg,min:angular.isNumber(t.min)?t.min:void 0,max:angular.isNumber(t.max)?t.max:void 0,empty:t.empty}}):void 0}var m,d,f,h,p,v,g,y,x,S,A,w,C={top:0,right:5,bottom:5,left:90},D=e._CHART_HEIGHT_HINT,E=e._CHART_WIDTH_HINT-C.left-C.right,T=D-C.top-C.bottom,H=T-C.top-C.bottom-15,P=T+C.top;"undefined"!=typeof o.showYAxisValues&&(m="true"===o.showYAxisValues),r.$watchCollection("data",function(t){t&&(n.dataPoints=u(angular.fromJson(t)),r.render(n.dataPoints))}),r.render=function(t){t&&t.length>0&&(console.time("contextChartRender"),s(),c(t),l(),console.timeEnd("contextChartRender"))}}}return e.Factory=function(){var t=function(t){return new e(t)};return t.$inject=["$rootScope"],t},e._CHART_WIDTH_HINT=750,e._CHART_HEIGHT_HINT=50,e._XAXIS_HEIGHT=15,e}();t.ContextChartDirective=a,e.directive("hkContextChart",a.Factory())}(Charts||(Charts={}));var Charts;!function(t){"use strict";var e=function(){function t(t){this.value=t}return t.prototype.toString=function(){return this.value},t.CHART_TIMERANGE_CHANGED=new t("ChartTimeRangeChanged"),t.AVAIL_CHART_TIMERANGE_CHANGED=new t("AvailChartTimeRangeChanged"),t.TIMELINE_CHART_TIMERANGE_CHANGED=new t("TimelineChartTimeRangeChanged"),t.TIMELINE_CHART_DOUBLE_CLICK_EVENT=new t("TimelineChartDoubleClickEvent"),t.CONTEXT_CHART_TIMERANGE_CHANGED=new t("ContextChartTimeRangeChanged"),t.DATE_RANGE_DRAG_CHANGED=new t("DateRangeDragChanged"),t}();t.EventNames=e}(Charts||(Charts={}));var Charts;!function(t){"use strict";function e(t,e,a,n,r){var i=1,o=t.selectAll(".dataPointDot").data(r);o.attr("class","dataPointDot").attr("r",i).attr("cx",function(t){return e(t.timestamp)}).attr("cy",function(t){return t.avg?a(t.avg):-9999999}).on("mouseover",function(t,e){n.show(t,e)}).on("mouseout",function(){n.hide()}),o.enter().append("circle").attr("class","dataPointDot").attr("r",i).attr("cx",function(t){return e(t.timestamp)}).attr("cy",function(t){return t.avg?a(t.avg):-9999999}).on("mouseover",function(t,e){n.show(t,e)}).on("mouseout",function(){n.hide()}),o.exit().remove()}t.createDataPoints=e}(Charts||(Charts={}));var Charts;!function(t){"use strict";function e(t,e,a){var n=t||"monotone",r=d3.svg.line().interpolate(n).x(function(t){return e(t.timestamp)}).y(function(t){return a(t.value)});return r}function a(a,n){var r,i=a[a.length-1];if(r=i.min||i.max){var o=d3.svg.area().interpolate(n.interpolation).defined(function(e){return!t.isEmptyDataPoint(e)}).x(function(t){return n.timeScale(t.timestamp)}).y(function(t){return n.yScale(t.max)}).y0(function(t){return n.yScale(t.min)}),s=n.svg.selectAll("path.ConeArea").data([a]);s.attr("class","coneArea").attr("d",o),s.enter().append("path").attr("class","coneArea").attr("d",o),s.exit().remove()}var c=n.svg.selectAll(".forecastLine").data([a]);c.attr("class","forecastLine").attr("d",e("monotone",n.timeScale,n.yScale)),c.enter().append("path").attr("class","forecastLine").attr("d",e("monotone",n.timeScale,n.yScale)),c.exit().remove()}t.showForecastData=a}(Charts||(Charts={}));var Charts;!function(t){"use strict";var e=!1;t.DEFAULT_Y_SCALE=10,t.X_AXIS_HEIGHT=25,t.HOVER_DATE_TIME_FORMAT="MM/DD/YYYY h:mm a",t.margin={top:10,right:5,bottom:5,left:90},angular.module("hawkular.charts").directive("hkMetricChart",["$rootScope","$http","$window","$interval","$log",function(a,n,r,i,o){function s(r,s,c){function l(){V&&G.selectAll("*").remove(),G=d3.select(s[0]);var e=s[0].parentNode;return t.width=e.clientWidth,M=e.clientHeight,0===t.width?void console.error("Error setting up chart. Width is 0 on chart parent container."):0===M?void console.error("Error setting up chart. Height is 0 on chart parent container."):(_=M-t.margin.top-t.margin.bottom-t.X_AXIS_HEIGHT,St=M+t.margin.top,V=G.append("svg").attr("width",t.width+t.margin.left+t.margin.right).attr("height",St),Y=V.append("g").attr("transform","translate("+t.margin.left+","+t.margin.top+")"),I=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(t,e){return g(t,e)}),Y.call(I),void Y.append("g").attr("class","alertHolder"))}function u(e){e&&(U=d3.max(e.map(function(e){return t.isEmptyDataPoint(e)?0:e.avg||e.value})),X=d3.min(e.map(function(e){return t.isEmptyDataPoint(e)?void 0:e.avg||e.value}))),$=xt?0:.95*X,O=U+.2*(U-X),at&&(O=Math.max(O,1.2*at),$=Math.min($,.95*at)),O=O||$?O:t.DEFAULT_Y_SCALE}function m(){return d3.scale.linear().clamp(!0).rangeRound([_,0]).domain([$,O])}function d(e){var a=t.determineXAxisTicksFromScreenWidth(t.width-t.margin.left-t.margin.right),n=t.determineYAxisTicksFromScreenHeight(_);if(e.length>0){b=e,u(e),L=m(),k=d3.svg.axis().scale(L).ticks(n).tickSize(4,4,0).orient("left");var r=d3.min(e.map(function(t){return t.timestamp})),i=void 0;i=P&&P.length>0?P[P.length-1].timestamp:d3.max(e.map(function(t){return t.timestamp})),R=d3.time.scale().range([0,t.width-t.margin.left-t.margin.right]).nice().domain([r,i]),N=d3.svg.axis().scale(R).ticks(a).tickFormat(t.xAxisTimeFormats()).tickSize(4,4,0).orient("bottom")}}function f(e){function a(){var a,n,r,i,o=[],s=[];return e.forEach(function(e){a=d3.max(e.values.map(function(e){return t.isEmptyDataPoint(e)?0:e.avg})),o.push(a),n=d3.min(e.values.map(function(e){return t.isEmptyDataPoint(e)?Number.MAX_VALUE:e.avg})),s.push(n)}),r=d3.max(o),i=d3.min(s),[i,r]}var n,r,i=a();return U=i[1],X=i[0],$=xt?0:X-.05*X,at?(n=1.2*at,r=U+.2*(U-X),O=n>r?n:r):O=U+.2*(U-X),[$,O||$?O:t.DEFAULT_Y_SCALE]}function h(e){var a=t.determineXAxisTicksFromScreenWidth(t.width-t.margin.left-t.margin.right),n=t.determineXAxisTicksFromScreenWidth(_);if(e&&e[0]&&e[0].values){var r=f(e);$=r[0],O=r[1],L=d3.scale.linear().clamp(!0).rangeRound([_,0]).domain([$,O]),k=d3.svg.axis().scale(L).ticks(n).tickSize(4,4,0).orient("left"),R=d3.time.scale().range([0,t.width-t.margin.left-t.margin.right]).domain([d3.min(e,function(t){return d3.min(t.values,function(t){return t.timestamp})}),d3.max(e,function(t){return d3.max(t.values,function(t){return t.timestamp})})]),N=d3.svg.axis().scale(R).ticks(a).tickFormat(t.xAxisTimeFormats()).tickSize(4,4,0).orient("bottom")}}function p(t,e,a,i,s){void 0===s&&(s=60);var c={headers:{"Hawkular-Tenant":Z},params:{start:a,end:i,buckets:s}};if(a>=i&&o.log("Start date was after end date"),t&&Q&&e){var l=Q.split("-");n.get(t+"/"+l[0]+"s/"+e+"/"+(l[1]||"data"),c).success(function(t){W=v(t),r.render(W)}).error(function(t,e){o.error("Error Loading Chart Data:"+e+", "+t)})}}function v(t){return t?t.map(function(t){var e=t.timestamp||t.start+(t.end-t.start)/2;return{timestamp:e,date:new Date(e),value:angular.isNumber(t.value)?t.value:void 0,avg:t.empty?void 0:t.avg,min:angular.isNumber(t.min)?t.min:void 0,max:angular.isNumber(t.max)?t.max:void 0,empty:t.empty}}):void 0}function g(e,a){var n,r,i,o=e.timestamp,s=moment(e.timestamp).format(t.HOVER_DATE_TIME_FORMAT);return a>0&&(r=b[a-1].timestamp,i=moment(o).from(moment(r),!0)),n=t.isEmptyDataPoint(e)?"<div class='chartHover'>\n                <small class='chartHoverLabel'>"+ut+"</small>\n                <div><small><span class='chartHoverLabel'>"+mt+"</span><span>:\n                </span><span class='chartHoverValue'>"+i+"</span></small> </div>\n                <hr/>\n                <div><small><span class='chartHoverLabel'>"+pt+"</span><span>:\n                </span><span class='chartHoverValue'>"+s+"</span></small></div>\n                </div>":t.isRawMetric(e)?"<div class='chartHover'>\n                <div><small><span class='chartHoverLabel'>"+pt+"</span><span>: </span>\n                <span class='chartHoverValue'>"+s+"</span></small></div>\n                  <div><small><span class='chartHoverLabel'>"+mt+"</span><span>: </span>\n                  <span class='chartHoverValue'>"+i+"</span></small></div>\n                  <hr/>\n                  <div><small><span class='chartHoverLabel'>"+lt+"</span><span>: </span>\n                  <span class='chartHoverValue'>"+d3.round(e.value,2)+"</span></small> </div>\n                  </div> ":"<div class='chartHover'>\n                    <div class='info-item'>\n                      <span class='chartHoverLabel'>"+pt+":</span>\n                      <span class='chartHoverValue'>"+s+"</span>\n                    </div>\n                    <div class='info-item before-separator'>\n                      <span class='chartHoverLabel'>"+mt+":</span>\n                      <span class='chartHoverValue'>"+i+"</span>\n                    </div>\n                    <div class='info-item separator'>\n                      <span class='chartHoverLabel'>"+ft+":</span>\n                      <span class='chartHoverValue'>"+d3.round(e.max,2)+"</span>\n                    </div>\n                    <div class='info-item'>\n                      <span class='chartHoverLabel'>"+ht+":</span>\n                      <span class='chartHoverValue'>"+d3.round(e.avg,2)+"</span>\n                    </div>\n                    <div class='info-item'>\n                      <span class='chartHoverLabel'>"+dt+":</span>\n                      <span class='chartHoverValue'>"+d3.round(e.min,2)+"</span>\n                    </div>\n                  </div> "}function y(){var e=t.determineYAxisGridLineTicksFromScreenHeight(_);if(L=m()){var a=Y.selectAll("g.grid.y_grid");a[0].length||(a=Y.append("g").classed("grid y_grid",!0)),a.call(d3.svg.axis().scale(L).orient("left").ticks(e).tickSize(-t.width,0).tickFormat(""))}}function x(){function t(t){t.transition().delay(250).duration(750).attr("opacity",1)}if(k){Y.selectAll("g.axis").remove();var e=(Y.append("g").attr("class","x axis").attr("transform","translate(0,"+_+")").attr("opacity",.3).call(N).call(t),Y.append("g").attr("class","y axis").attr("opacity",.3).call(k).call(t),Y.selectAll(".yAxisUnitsLabel"));_>=150&&c.yAxisUnits&&(e=Y.append("text").attr("class","yAxisUnitsLabel").attr("transform","rotate(-90),translate(-20,-50)").attr("x",-_/2).style("text-anchor","center").text("NONE"===c.yAxisUnits?"":c.yAxisUnits).attr("opacity",.3).call(t))}}function S(e){var a=e||"monotone",n=d3.svg.line().interpolate(a).defined(function(e){return!t.isEmptyDataPoint(e)}).x(function(t){return R(t.timestamp)}).y(function(e){return L(t.isRawMetric(e)?e.value:e.avg)});return n}function A(){if("bar"===ct||"scatterline"===ct){var t=Y.selectAll(".barAvgLine").data([b]);t.attr("class","barAvgLine").attr("d",S("monotone")),t.enter().append("path").attr("class","barAvgLine").attr("d",S("monotone")),t.exit().remove()}}function w(){function e(){Y.classed("selecting",!0)}function n(){var e=F.extent(),n=Math.round(e[0].getTime()),r=Math.round(e[1].getTime()),i=r-n;if(Y.classed("selecting",!d3.event.target.empty()),i>=6e4){P=[];new t.ChartOptions(Y,R,L,b,H,_,M,I,O,yt,nt);a.$broadcast(t.EventNames.CHART_TIMERANGE_CHANGED.toString(),e)}B.call(F.clear())}B=Y.selectAll("g.brush"),B.empty()&&(B=Y.append("g").attr("class","brush")),F=d3.svg.brush().x(R).on("brushstart",e).on("brushend",n),B.call(F),B.selectAll(".resize").append("path"),B.selectAll("rect").attr("height",_)}function C(t){t&&Y.append("path").datum(t).attr("class","prevRangeAvgLine").style("stroke-dasharray","9,3").attr("d",S("linear"))}function D(t){t&&Y.selectAll(".annotationDot").data(t).enter().append("circle").attr("class","annotationDot").attr("r",5).attr("cx",function(t){return R(t.timestamp)}).attr("cy",function(){return M-L(O)}).style("fill",function(t){return"1"===t.severity?"red":"2"===t.severity?"yellow":"white"})}function E(){rt=Date.now(),it=moment().subtract(tt,"seconds").valueOf(),p(K,q,it,rt,60)}function T(t,e){At.forEach(function(a){a.name===t&&a.drawChart(e)})}var H,P,M,_,b,L,R,k,N,I,F,B,V,G,Y,$,O,U,X,W,z,j,J=[],K=c.metricUrl,q=c.metricId||"",Z=c.metricTenantId||"",Q=c.metricType||"gauge",tt=+c.timeRangeInSeconds||43200,et=+c.refreshIntervalInSeconds||3600,at=+c.alertValue,nt=c.interpolation||"monotone",rt=Date.now(),it=rt-tt,ot=[],st=[],ct=c.chartType||"line",lt=c.singleValueLabel||"Raw Value",ut=c.noDataLabel||"No Data",mt=c.durationLabel||"Interval",dt=c.minLabel||"Min",ft=c.maxLabel||"Max",ht=c.avgLabel||"Avg",pt=c.timestampLabel||"Timestamp",vt=!0,gt=!1,yt=!1,xt=!1,St=M+t.margin.top+t.margin.bottom;J=c.data,P=c.forecastData,gt=c.showDataPoints,ot=c.previousRangeData,st=c.annotationData;var At=[];At.push(new t.LineChart),At.push(new t.AreaChart),At.push(new t.ScatterChart),At.push(new t.ScatterLineChart),At.push(new t.HistogramChart),At.push(new t.RhqBarChart),At.push(new t.MultiLineChart),r.$watchCollection("data",function(t,e){(t||e)&&(W=angular.fromJson(t||[]),r.render(W))}),r.$watch("multiData",function(t,e){(t||e)&&(H=angular.fromJson(t||[]),r.render(W))},!0),r.$watch("previousRangeData",function(t){t&&(z=angular.fromJson(t),r.render(W))},!0),r.$watch("annotationData",function(t){t&&(st=angular.fromJson(t),r.render(W))},!0),r.$watch("forecastData",function(t){t&&(P=angular.fromJson(t),r.render(W))},!0),r.$watchGroup(["alertValue","chartType","hideHighLowValues","useZeroMinValue","showAvgLine"],function(t){at=t[0]||at,ct=t[1]||ct,yt="undefined"!=typeof t[2]?t[2]:yt,xt="undefined"!=typeof t[3]?t[3]:xt,vt="undefined"!=typeof t[4]?t[4]:vt,r.render(W)}),r.$watchGroup(["metricUrl","metricId","metricType","metricTenantId","timeRangeInSeconds"],function(t){K=t[0]||K,q=t[1]||q,Q=t[2]||q,Z=t[3]||Z,tt=t[4]||tt,E()}),r.$watch("refreshIntervalInSeconds",function(t){t&&(et=+t,i.cancel(j),j=i(function(){E()},1e3*et))}),r.$on("$destroy",function(){i.cancel(j)}),r.$on(t.EventNames.DATE_RANGE_DRAG_CHANGED,function(e,a){r.$emit(t.EventNames.CHART_TIMERANGE_CHANGED,a)}),r.$on(t.EventNames.CHART_TIMERANGE_CHANGED,function(t,e){c.forecastData=[],P=[],r.$digest()}),r.render=function(a){if(a||H){e&&(console.group("Render Chart"),console.time("chartRender")),l(),a?d(a):h(H);var n=new t.ChartOptions(Y,R,L,b,H,_,M,I,O,yt,nt);at&&at>$&&O>at&&t.createAlertBoundsArea(n,at,O),w(),y(),T(ct,n),gt&&t.createDataPoints(Y,R,L,I,b),C(ot),x(),vt&&A(),at&&at>$&&O>at&&t.createAlertLine(n,at,"alertLine"),st&&D(st),P&&P.length>0&&t.showForecastData(P,n),e&&(console.timeEnd("chartRender"),console.groupEnd("Render Chart"))}}}return{link:s,restrict:"E",replace:!0,scope:{data:"=",multiData:"=",forecastData:"=",metricUrl:"@",metricId:"@",metricType:"@",metricTenantId:"@",startTimestamp:"@",endTimestamp:"@",timeRangeInSeconds:"@",refreshIntervalInSeconds:"@",previousRangeData:"@",annotationData:"@",showDataPoints:"=",alertValue:"@",interpolation:"@",chartType:"@",yAxisUnits:"@",useZeroMinValue:"=",chartHoverDateFormat:"@",chartHoverTimeFormat:"@",singleValueLabel:"@",noDataLabel:"@",durationLabel:"@",minLabel:"@",maxLabel:"@",avgLabel:"@",timestampLabel:"@",showAvgLine:"=",hideHighLowValues:"="}}}])}(Charts||(Charts={}));var __extends=this&&this.__extends||function(t,e){function a(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)},Charts;!function(t){"use strict";var e=function(){function t(t,e,a,n,r){this.timestamp=t,this.eventSource=e,this.provider=a,this.message=n,this.middlewareResource=r}return t}();t.EmsEvent=e;var a=function(t){function e(e,a,n,r,i,o,s,c,l){t.call(this,e,a,n,r,i),this.timestamp=e,this.eventSource=a,this.provider=n,this.message=r,this.middlewareResource=i,this.formattedDate=o,this.color=s,this.row=c,this.selected=l,this.formattedDate=moment(e).format("MMMM Do YYYY, h:mm:ss a"),this.selected=!1}return __extends(e,t),e.buildEvents=function(t){return t?t.map(function(t){return{timestamp:t.timestamp,eventSource:t.eventSource,provider:t.eventSource,message:t.message,middlewareResource:t.middlewareResource,formattedDate:moment(t.timestamp).format("MMMM Do YYYY, h:mm:ss a"),color:"Hawkular"===t.eventSource?"#0088ce":"#ec7a08",row:r.nextRow(),selected:!1}}):void 0},e.buildFakeEvents=function(t,a,i){for(var o=[],s=(i-a)/t,c=a;i>c;c+=s){var l=n.randomBetween(a,i),u=new e(l,"Hawkular","Hawkular Provider","Some Message","Resource-"+n.randomBetween(10,100),moment(c).format("MMMM Do YYYY, h:mm:ss a"),"0088ce",r.nextRow());o.push(u)}return o},e}(e);t.TimelineEvent=a;var n=function(){function t(){}return t.randomBetween=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},t}();t.Random=n;var r=function(){function t(){}return t.nextRow=function(){var e=5;return t._currentRow++,t._currentRow>e&&(t._currentRow=1),e+1-t._currentRow},t._currentRow=0,t}(),i=angular.module("hawkular.charts"),o=function(){function e(n){var r=this;this.restrict="E",this.replace=!0,this.scope={events:"=",startTimestamp:"@",endTimestamp:"@",showLabels:"@"},this.link=function(i,o,s){function c(t){return"<div class='chartHover'>\n            <div class='info-item'>\n              <span class='chartHoverLabel'>Event Source:</span>\n              <span class='chartHoverValue'>"+t.eventSource+"</span>\n            </div>\n            <div class='info-item'>\n              <span class='chartHoverLabel'>Provider:</span>\n              <span class='chartHoverValue'>"+t.provider+"</span>\n            </div>\n            <div class='info-item'>\n              <span class='chartHoverLabel'>Message:</span>\n              <span class='chartHoverValue'>"+t.message+"</span>\n            </div>\n            <div class='info-item'>\n              <span class='chartHoverLabel'>Middleware Resource:</span>\n              <span class='chartHoverValue'>"+t.middlewareResource+"</span>\n            </div>\n            <div class='info-item'>\n              <span class='chartHoverLabel'>Date Time:</span>\n              <span class='chartHoverValue'>"+moment(t.timestamp).format("M/d/YY, H:mm:ss ")+"</span>\n            </div>\n          </div>"}function l(){w&&C.selectAll("*").remove(),C=d3.select(o[0]),w=C.append("svg").attr("viewBox","0 0 760 150").attr("preserveAspectRatio","xMinYMin meet"),A=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(t){return c(t)}),D=w.append("g").attr("width",_+M.left+M.right).attr("height",N).attr("transform","translate("+M.left+","+I+")"),D.call(A)}function u(e){var a=[];E=+s.startTimestamp||d3.min(e,function(t){return t.timestamp})||+moment().subtract(24,"hour"),e&&e.length>0&&(a[0]=E,a[1]=T||+moment(),h=d3.scale.linear().clamp(!0).rangeRound([70,0]).domain([0,175]),v=d3.svg.axis().scale(h).ticks(0).tickSize(0,0).orient("left"),p=d3.time.scale().range([0,_]).domain(a),g=d3.svg.axis().scale(p).tickSize(-70,0).orient("top").tickFormat(t.xAxisTimeFormats()))}function m(e){var a=d3.min(e,function(t){return+t.timestamp}),r=d3.max(e,function(t){return+t.timestamp}),i=d3.time.scale().range([0,_]).domain([a,r]),o=d3.scale.linear().clamp(!0).range([L,0]).domain([0,6]);D.append("line").attr("x1",0).attr("y1",70).attr("x2",735).attr("y2",70).attr("class","hkTimelineBottomLine"),D.selectAll("circle").data(e).enter().append("circle").attr("class",function(t){return t.selected?"hkEventSelected":"hkEvent"}).attr("cx",function(t){return i(new Date(t.timestamp))}).attr("cy",function(t){return o(t.row)}).attr("fill",function(t){return t.color}).attr("r",function(t){return 6}).on("mouseover",function(t,e){A.show(t,e)}).on("mouseout",function(){A.hide()}).on("dblclick",function(e){console.log("Double-Clicked:"+e.middlewareResource),e.selected=!e.selected,n.$broadcast(t.EventNames.TIMELINE_CHART_DOUBLE_CLICK_EVENT.toString(),e)}),P&&D.selectAll("text").data(e).enter().append("text").attr("class","hkEventLabel").attr("x",function(t){return i(new Date(t.timestamp))+10}).attr("y",function(t){return o(t.row)+5}).style("text-anchor","start").text(function(t){return t.middlewareResource})}function d(){D.selectAll("g.axis").remove(),y=D.append("g").attr("class","x axis").call(g),D.append("g").attr("class","y axis").call(v)}function f(){function e(){D.classed("selecting",!0)}function a(){var e=x.extent(),a=Math.round(e[0].getTime()),r=Math.round(e[1].getTime()),i=r-a;i>=6e4&&n.$broadcast(t.EventNames.TIMELINE_CHART_TIMERANGE_CHANGED.toString(),e),S.call(x.clear())}x=d3.svg.brush().x(p).on("brushstart",e).on("brushend",a),S=D.append("g").attr("class","brush").call(x),S.selectAll(".resize").append("path"),S.selectAll("rect").attr("height",70)}var h,p,v,g,y,x,S,A,w,C,D,E=+s.startTimestamp,T=+s.endTimestamp,H=e._CHART_HEIGHT,P=s.showLabels,M={top:10,right:5,bottom:5,left:10},_=e._CHART_WIDTH-M.left-M.right,b=H-50,L=b-M.top-M.bottom,R=30,k=10,N=L+M.top-R-k,I=+R+k+M.top;i.$watchCollection("events",function(t){t&&(r.events=a.buildEvents(angular.fromJson(t)),i.render(r.events))}),i.$watchGroup(["startTimestamp","endTimestamp"],function(t){E=+t[0]||E,T=+t[1]||T,i.render(r.events)}),i.render=function(t){t&&t.length>0&&(l(),u(t),d(),f(),m(t))}}}return e.Factory=function(){var t=function(t){return new e(t)};return t.$inject=["$rootScope"],t},e._CHART_HEIGHT=150,e._CHART_WIDTH=750,e}();t.TimelineChartDirective=o,i.directive("hkTimelineChart",o.Factory())}(Charts||(Charts={}));var Charts;!function(t){"use strict";var e=function(){function t(t,e,a,n,r,i,o,s,c,l,u){this.svg=t,this.timeScale=e,this.yScale=a,this.chartData=n,this.multiChartData=r,this.modifiedInnerChartHeight=i,this.height=o,this.tip=s,this.visuallyAdjustedMax=c,this.hideHighLowValues=l,this.interpolation=u}return t}();t.ChartOptions=e}(Charts||(Charts={}));var Charts;!function(t){"use strict";function e(e,a,n){return void 0===n&&(n=t.BAR_OFFSET),e/a-n}function a(a,n){return 0===a||a===n-1?e(t.width,n,t.BAR_OFFSET)/2:e(t.width,n,t.BAR_OFFSET)}function n(a,n,r,i){return r(a.timestamp)-(0===n?0:e(t.width,i,t.BAR_OFFSET)/2)}function r(t){return t.empty}function i(t){return"undefined"==typeof t.avg}function o(){return d3.time.format.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%H:%M",function(t){return t.getMinutes()}],["%H:%M",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!==t.getDate()}],["%b %d",function(t){return 1!==t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",function(){return!0}]])}function s(t){var e=t.append("defs");e.append("pattern").attr("id","noDataStripes").attr("patternUnits","userSpaceOnUse").attr("x","0").attr("y","0").attr("width","6").attr("height","3").append("path").attr("d","M 0 0 6 0").attr("style","stroke:#CCCCCC; fill:none;"),e.append("pattern").attr("id","unknownStripes").attr("patternUnits","userSpaceOnUse").attr("x","0").attr("y","0").attr("width","6").attr("height","3").attr("style","stroke:#2E9EC2; fill:none;").append("path").attr("d","M 0 0 6 0"),
e.append("pattern").attr("id","downStripes").attr("patternUnits","userSpaceOnUse").attr("x","0").attr("y","0").attr("width","6").attr("height","3").attr("style","stroke:#ff8a9a; fill:none;").append("path").attr("d","M 0 0 6 0")}function c(t,e){return e(t.timestamp)}function l(t){var e,a,n,r=0;if(0===t.length)return r;for(e=0,n=t.length;n>e;e++)a=t.charCodeAt(e),r=(r<<5)-r+a,r|=0;return r}function u(t){var e;return e=200>=t?2:350>=t&&t>200?4:9}function m(t){var e;return e=120>=t?3:9}function d(t){var e;return e=60>=t?0:10}t.calcBarWidth=e,t.calcBarWidthAdjusted=a,t.calcBarXPos=n,t.isEmptyDataPoint=r,t.isRawMetric=i,t.xAxisTimeFormats=o,t.createSvgDefs=s,t.xMidPointStartPosition=c,t.hashString=l,t.determineXAxisTicksFromScreenWidth=u,t.determineYAxisTicksFromScreenHeight=m,t.determineYAxisGridLineTicksFromScreenHeight=d}(Charts||(Charts={}));var Charts;!function(t){"use strict";t.BAR_OFFSET=2;var e=function(){function e(){this.name="histogram"}return e.prototype.drawChart=function(e,a){function n(n){n.attr("class",m).on("mouseover",function(t,a){e.tip.show(t,a)}).on("mouseout",function(){e.tip.hide()}).transition().attr("x",function(a,n){return t.calcBarXPos(a,n,e.timeScale,e.chartData.length)}).attr("width",function(a,n){return t.calcBarWidthAdjusted(n,e.chartData.length)}).attr("y",function(a){return t.isEmptyDataPoint(a)?0:e.yScale(a.avg)}).attr("height",function(a){return e.modifiedInnerChartHeight-e.yScale(t.isEmptyDataPoint(a)?e.yScale(e.visuallyAdjustedMax):a.avg)}).attr("opacity",a?".6":"1").attr("fill",function(e){return t.isEmptyDataPoint(e)?"url(#noDataStripes)":a?"#D3D3D6":"#C0C0C0"}).attr("stroke",function(t){return"#777"}).attr("stroke-width",function(t){return"0"}).attr("data-hawkular-value",function(t){return t.avg})}function r(a){a.attr("class",function(t){return t.min===t.max?"singleValue":"high"}).attr("x",function(a,n){return t.calcBarXPos(a,n,e.timeScale,e.chartData.length)}).attr("y",function(t){return isNaN(t.max)?e.yScale(e.visuallyAdjustedMax):e.yScale(t.max)}).attr("height",function(a){return t.isEmptyDataPoint(a)?0:e.yScale(a.avg)-e.yScale(a.max)||2}).attr("width",function(a,n){return t.calcBarWidthAdjusted(n,e.chartData.length)}).attr("opacity",.9).on("mouseover",function(t,a){e.tip.show(t,a)}).on("mouseout",function(){e.tip.hide()})}function i(a){a.attr("class","low").attr("x",function(a,n){return t.calcBarXPos(a,n,e.timeScale,e.chartData.length)}).attr("y",function(t){return isNaN(t.avg)?e.height:e.yScale(t.avg)}).attr("height",function(a){return t.isEmptyDataPoint(a)?0:e.yScale(a.min)-e.yScale(a.avg)}).attr("width",function(a,n){return t.calcBarWidthAdjusted(n,e.chartData.length)}).attr("opacity",.9).on("mouseover",function(t,a){e.tip.show(t,a)}).on("mouseout",function(){e.tip.hide()})}function o(a){a.attr("class","histogramTopStem").filter(function(e){return!t.isEmptyDataPoint(e)}).attr("x1",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("x2",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("y1",function(t){return e.yScale(t.max)}).attr("y2",function(t){return e.yScale(t.avg)}).attr("stroke",function(t){return"red"}).attr("stroke-opacity",function(t){return.6})}function s(a){a.filter(function(e){return!t.isEmptyDataPoint(e)}).attr("class","histogramBottomStem").attr("x1",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("x2",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("y1",function(t){return e.yScale(t.avg)}).attr("y2",function(t){return e.yScale(t.min)}).attr("stroke",function(t){return"red"}).attr("stroke-opacity",function(t){return.6})}function c(a){a.filter(function(e){return!t.isEmptyDataPoint(e)}).attr("class","histogramTopCross").attr("x1",function(a){return t.xMidPointStartPosition(a,e.timeScale)-3}).attr("x2",function(a){return t.xMidPointStartPosition(a,e.timeScale)+3}).attr("y1",function(t){return e.yScale(t.max)}).attr("y2",function(t){return e.yScale(t.max)}).attr("stroke",function(t){return"red"}).attr("stroke-width",function(t){return"0.5"}).attr("stroke-opacity",function(t){return.6})}function l(a){a.filter(function(e){return!t.isEmptyDataPoint(e)}).attr("class","histogramBottomCross").attr("x1",function(a){return t.xMidPointStartPosition(a,e.timeScale)-3}).attr("x2",function(a){return t.xMidPointStartPosition(a,e.timeScale)+3}).attr("y1",function(t){return e.yScale(t.min)}).attr("y2",function(t){return e.yScale(t.min)}).attr("stroke",function(t){return"red"}).attr("stroke-width",function(t){return"0.5"}).attr("stroke-opacity",function(t){return.6})}function u(t,a,n){if(n){var u=t.selectAll("rect.high, rect.singleValue").data(a);u.call(r),u.enter().append("rect").call(r),u.exit().remove();var m=t.selectAll("rect.low").data(e.chartData);m.call(i),m.enter().append("rect").call(i),m.exit().remove()}else{var d=t.selectAll(".histogramTopStem").data(e.chartData);d.call(o),d.enter().append("line").call(o),d.exit().remove();var f=t.selectAll(".histogramBottomStem").data(e.chartData);f.call(s),f.enter().append("line").call(s),f.exit().remove();var h=t.selectAll(".histogramTopCross").data(e.chartData);h.call(c),h.enter().append("line").call(c),h.exit().remove();var p=t.selectAll(".histogramBottomCross").data(e.chartData);p.call(l),p.enter().append("line").call(l),p.exit().remove()}}void 0===a&&(a=!1);var m=a?"leaderBar":"histogram",d=e.svg.selectAll("rect."+m).data(e.chartData);d.call(n),d.enter().append("rect").call(n),d.exit().remove(),e.hideHighLowValues?e.svg.selectAll(".histogramTopStem, .histogramBottomStem, .histogramTopCross, .histogramBottomCross").remove():u(e.svg,e.chartData,a)},e}();t.AbstractHistogramChart=e}(Charts||(Charts={}));var Charts;!function(t){"use strict";var e=function(){function e(){this.name="area"}return e.prototype.drawChart=function(e){var a=d3.svg.area().interpolate(e.interpolation).defined(function(e){return!t.isEmptyDataPoint(e)}).x(function(t){return e.timeScale(t.timestamp)}).y(function(a){return t.isRawMetric(a)?e.yScale(a.value):e.yScale(a.max)}).y0(function(a){return t.isRawMetric(a)?e.yScale(a.value):e.yScale(a.avg)}),n=d3.svg.area().interpolate(e.interpolation).defined(function(e){return!t.isEmptyDataPoint(e)}).x(function(t){return e.timeScale(t.timestamp)}).y(function(a){return t.isRawMetric(a)?e.yScale(a.value):e.yScale(a.avg)}).y0(function(t){return e.hideHighLowValues?e.height:e.yScale(t.min)}),r=d3.svg.area().interpolate(e.interpolation).defined(function(e){return!t.isEmptyDataPoint(e)}).x(function(t){return e.timeScale(t.timestamp)}).y(function(a){return t.isRawMetric(a)?e.yScale(a.value):e.yScale(a.min)}).y0(function(){return e.modifiedInnerChartHeight});if(!e.hideHighLowValues){var i=e.svg.selectAll("path.highArea").data([e.chartData]);i.attr("class","highArea").attr("d",a),i.enter().append("path").attr("class","highArea").attr("d",a),i.exit().remove();var o=e.svg.selectAll("path.lowArea").data([e.chartData]);o.attr("class","lowArea").attr("d",r),o.enter().append("path").attr("class","lowArea").attr("d",r),o.exit().remove()}var s=e.svg.selectAll("path.avgArea").data([e.chartData]);s.attr("class","avgArea").attr("d",n),s.enter().append("path").attr("class","avgArea").attr("d",n),s.exit().remove()},e}();t.AreaChart=e}(Charts||(Charts={}));var ChartOptions=Charts.ChartOptions,__extends=this&&this.__extends||function(t,e){function a(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)},Charts;!function(t){"use strict";var e=function(t){function e(){t.apply(this,arguments),this.name="histogram"}return __extends(e,t),e.prototype.drawChart=function(e,a){void 0===a&&(a=!1),t.prototype.drawChart.call(this,e,a)},e}(t.AbstractHistogramChart);t.HistogramChart=e}(Charts||(Charts={}));var Charts;!function(t){"use strict";var e=function(){function e(){this.name="line"}return e.prototype.drawChart=function(e){var a=d3.svg.line().interpolate(e.interpolation).defined(function(e){return!t.isEmptyDataPoint(e)}).x(function(t){return e.timeScale(t.timestamp)}).y(function(a){return t.isRawMetric(a)?e.yScale(a.value):e.yScale(a.avg)}),n=e.svg.selectAll("path.metricLine").data([e.chartData]);n.attr("class","metricLine").transition().attr("d",a),n.enter().append("path").attr("class","metricLine").transition().attr("d",a),n.exit().remove()},e}();t.LineChart=e}(Charts||(Charts={}));var Charts;!function(t){"use strict";var e=function(){function e(){this.name="multiline"}return e.prototype.drawChart=function(e){var a=this,n=d3.scale.category10(),r=0;e.multiChartData?(e.svg.selectAll("path[id^='multiLine']")[0].forEach(function(a){var n=!1;e.multiChartData.forEach(function(e){e.keyHash=e.keyHash||"multiLine"+t.hashString(e.key),a.getAttribute("id")===e.keyHash&&(n=!0)}),n||a.remove()}),e.multiChartData.forEach(function(i){if(i&&i.values){i.keyHash=i.keyHash||"multiLine"+t.hashString(i.key);var o=e.svg.selectAll("path#"+i.keyHash).data([i.values]);o.attr("id",i.keyHash).attr("class","multiLine").attr("fill","none").attr("stroke",function(){return i.color||n(r++)}).transition().attr("d",a.createLine("linear",e.timeScale,e.yScale)),o.enter().append("path").attr("id",i.keyHash).attr("class","multiLine").attr("fill","none").attr("stroke",function(){return i.color?i.color:n(r++)}).transition().attr("d",a.createLine("linear",e.timeScale,e.yScale)),o.exit().remove()}})):console.warn("No multi-data set for multiline chart")},e.prototype.createLine=function(e,a,n){var r=e||"monotone",i=d3.svg.line().interpolate(r).defined(function(e){return!t.isEmptyDataPoint(e)}).x(function(t){return a(t.timestamp)}).y(function(e){return n(t.isRawMetric(e)?e.value:e.avg)});return i},e}();t.MultiLineChart=e}(Charts||(Charts={}));var __extends=this&&this.__extends||function(t,e){function a(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)},Charts;!function(t){"use strict";var e=function(t){function e(){t.apply(this,arguments),this.name="rhqbar"}return __extends(e,t),e.prototype.drawChart=function(e,a){void 0===a&&(a=!0),t.prototype.drawChart.call(this,e,a)},e}(t.AbstractHistogramChart);t.RhqBarChart=e}(Charts||(Charts={}));var Charts;!function(t){"use strict";var e=function(){function e(){this.name="scatter"}return e.prototype.drawChart=function(e){if(e.hideHighLowValues)e.svg.selectAll(".highDot, .lowDot").remove();else{var a=e.svg.selectAll(".highDot").data(e.chartData);a.attr("class","highDot").filter(function(e){return!t.isEmptyDataPoint(e)}).attr("r",3).attr("cx",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("cy",function(a){return t.isRawMetric(a)?e.yScale(a.value):e.yScale(a.max)}).style("fill",function(){return"#ff1a13"}).on("mouseover",function(t,e){}).on("mouseout",function(){}),a.enter().append("circle").filter(function(e){return!t.isEmptyDataPoint(e)}).attr("class","highDot").attr("r",3).attr("cx",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("cy",function(a){return t.isRawMetric(a)?e.yScale(a.value):e.yScale(a.max)}).style("fill",function(){return"#ff1a13"}).on("mouseover",function(t,e){}).on("mouseout",function(){}),a.exit().remove();var n=e.svg.selectAll(".lowDot").data(e.chartData);n.attr("class","lowDot").filter(function(e){return!t.isEmptyDataPoint(e)}).attr("r",3).attr("cx",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("cy",function(a){return t.isRawMetric(a)?e.yScale(a.value):e.yScale(a.min)}).style("fill",function(){return"#70c4e2"}).on("mouseover",function(t,e){}).on("mouseout",function(){}),n.enter().append("circle").filter(function(e){return!t.isEmptyDataPoint(e)}).attr("class","lowDot").attr("r",3).attr("cx",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("cy",function(a){return t.isRawMetric(a)?e.yScale(a.value):e.yScale(a.min)}).style("fill",function(){return"#70c4e2"}).on("mouseover",function(t,e){}).on("mouseout",function(){}),n.exit().remove()}var r=e.svg.selectAll(".avgDot").data(e.chartData);r.attr("class","avgDot").filter(function(e){return!t.isEmptyDataPoint(e)}).attr("r",3).attr("cx",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("cy",function(a){return t.isRawMetric(a)?e.yScale(a.value):e.yScale(a.avg)}).style("fill",function(){return"#FFF"}).on("mouseover",function(t,e){}).on("mouseout",function(){}),r.enter().append("circle").filter(function(e){return!t.isEmptyDataPoint(e)}).attr("class","avgDot").attr("r",3).attr("cx",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("cy",function(a){return t.isRawMetric(a)?e.yScale(a.value):e.yScale(a.avg)}).style("fill",function(){return"#FFF"}).on("mouseover",function(t,e){}).on("mouseout",function(){}),r.exit().remove()},e}();t.ScatterChart=e}(Charts||(Charts={}));var Charts;!function(t){"use strict";var e=function(){function e(){this.name="scatterline"}return e.prototype.drawChart=function(e){var a=e.svg.selectAll(".scatterLineTopStem").data(e.chartData);a.attr("class","scatterLineTopStem").filter(function(e){return!t.isEmptyDataPoint(e)}).attr("x1",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("x2",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("y1",function(t){return e.yScale(t.max)}).attr("y2",function(t){return e.yScale(t.avg)}).attr("stroke",function(t){return"#000"}),a.enter().append("line").filter(function(e){return!t.isEmptyDataPoint(e)}).attr("class","scatterLineTopStem").attr("x1",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("x2",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("y1",function(t){return e.yScale(t.max)}).attr("y2",function(t){return e.yScale(t.avg)}).attr("stroke",function(t){return"#000"}),a.exit().remove();var n=e.svg.selectAll(".scatterLineBottomStem").data(e.chartData);n.attr("class","scatterLineBottomStem").filter(function(e){return!t.isEmptyDataPoint(e)}).attr("x1",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("x2",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("y1",function(t){return e.yScale(t.avg)}).attr("y2",function(t){return e.yScale(t.min)}).attr("stroke",function(t){return"#000"}),n.enter().append("line").filter(function(e){return!t.isEmptyDataPoint(e)}).attr("class","scatterLineBottomStem").attr("x1",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("x2",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("y1",function(t){return e.yScale(t.avg)}).attr("y2",function(t){return e.yScale(t.min)}).attr("stroke",function(t){return"#000"}),n.exit().remove();var r=e.svg.selectAll(".scatterLineTopCross").data(e.chartData);r.attr("class","scatterLineTopCross").filter(function(e){return!t.isEmptyDataPoint(e)}).attr("x1",function(a){return t.xMidPointStartPosition(a,e.timeScale)-3}).attr("x2",function(a){return t.xMidPointStartPosition(a,e.timeScale)+3}).attr("y1",function(t){return e.yScale(t.max)}).attr("y2",function(t){return e.yScale(t.max)}).attr("stroke",function(t){return"#000"}).attr("stroke-width",function(t){return"0.5"}),r.enter().append("line").filter(function(e){return!t.isEmptyDataPoint(e)}).attr("class","scatterLineTopCross").attr("x1",function(a){return t.xMidPointStartPosition(a,e.timeScale)-3}).attr("x2",function(a){return t.xMidPointStartPosition(a,e.timeScale)+3}).attr("y1",function(t){return e.yScale(t.max)}).attr("y2",function(t){return e.yScale(t.max)}).attr("stroke",function(t){return"#000"}).attr("stroke-width",function(t){return"0.5"}),r.exit().remove();var i=e.svg.selectAll(".scatterLineBottomCross").data(e.chartData);i.attr("class","scatterLineBottomCross").filter(function(e){return!t.isEmptyDataPoint(e)}).attr("x1",function(a){return t.xMidPointStartPosition(a,e.timeScale)-3}).attr("x2",function(a){return t.xMidPointStartPosition(a,e.timeScale)+3}).attr("y1",function(t){return e.yScale(t.min)}).attr("y2",function(t){return e.yScale(t.min)}).attr("stroke",function(t){return"#000"}).attr("stroke-width",function(t){return"0.5"}),i.enter().append("line").filter(function(e){return!t.isEmptyDataPoint(e)}).attr("class","scatterLineBottomCross").attr("x1",function(a){return t.xMidPointStartPosition(a,e.timeScale)-3}).attr("x2",function(a){return t.xMidPointStartPosition(a,e.timeScale)+3}).attr("y1",function(t){return e.yScale(t.min)}).attr("y2",function(t){return e.yScale(t.min)}).attr("stroke",function(t){return"#000"}).attr("stroke-width",function(t){return"0.5"}),i.exit().remove();var o=e.svg.selectAll(".scatterDot").data(e.chartData);o.attr("class","scatterDot").filter(function(e){return!t.isEmptyDataPoint(e)}).attr("r",3).attr("cx",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("cy",function(a){return t.isRawMetric(a)?e.yScale(a.value):e.yScale(a.avg)}).style("fill",function(){return"#70c4e2"}).style("opacity",function(){return"1"}).on("mouseover",function(t,e){}).on("mouseout",function(){}),o.enter().append("circle").filter(function(e){return!t.isEmptyDataPoint(e)}).attr("class","scatterDot").attr("r",3).attr("cx",function(a){return t.xMidPointStartPosition(a,e.timeScale)}).attr("cy",function(a){return t.isRawMetric(a)?e.yScale(a.value):e.yScale(a.avg)}).style("fill",function(){return"#70c4e2"}).style("opacity",function(){return"1"}).on("mouseover",function(t,e){}).on("mouseout",function(){}),o.exit().remove()},e}();t.ScatterLineChart=e}(Charts||(Charts={}));